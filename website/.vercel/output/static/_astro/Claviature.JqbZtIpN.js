import{j as H}from"./jsx-runtime.CLpGMVip.js";import"./index.B9mnsnPE.js";const J=u=>{var o;if(typeof u!="string")return[];const[i,a="",s]=((o=u.match(/^([a-gA-G])([#bs]*)([0-9])?$/))==null?void 0:o.slice(1))||[];return i?[i,a,s?Number(s):void 0]:[]},K={"#":1,b:-1,s:1},b=u=>{if(typeof u=="number")return u;const[o,i,a]=J(u);if(!o)throw new Error('not a note: "'+u+'"');const s={c:0,d:2,e:4,f:5,g:7,a:9,b:11}[o.toLowerCase()],l=i?.split("").reduce((c,m)=>c+K[m],0)||0;return(Number(a)+1)*12+s+l};function P({options:u,onClick:o,onMouseDown:i,onMouseUp:a,onMouseLeave:s}){const{range:l=["A1","C6"],scaleX:c=1,scaleY:m=1,palette:f=["#39383D","#F2F2EF"],strokeWidth:k=1,stroke:v="black",upperWidth:U=14,upperHeight:M=100,lowerHeight:G=45,colorize:O=[],labels:R,topLabels:C}=u||{},y=[0,1,0,1,0,0,1,0,1,0,1,0],d=b(l[0]),S=b(l[1])-d+1,V=e=>{const n=[],r=[],h=b(e[1]);for(let p=d;p<=h;p++)(y[p%12]?r:n).push(p);return[n,r]},[X,Y]=V(l),t=U*c,g=e=>(e%12>4?7/4:5/3)*t,x=(M+G)*m,j=M*m,w=e=>Array.from({length:e-d},(n,r)=>r+d).reduce((n,r)=>y[r%12]?n:n+g(r),0),L=12-d%12,q=w(L+d)-L*t,$=e=>(e-d)*t+q,B=O.map(e=>({...e,keys:e.keys.map(n=>b(n))})),A=e=>{var n;return(n=B.find(({keys:r})=>r.includes(e)))==null?void 0:n.color},D=e=>()=>o?.(e),F=e=>()=>i?.(e),W=e=>()=>a?.(e),E=e=>()=>s?.(e),I=e=>y[e%12]===1;return{name:"svg",type:"element",value:"",attributes:{width:S*t+t+k*2,height:x},children:[...X.map(e=>{var n;return{name:"rect",type:"element",value:"",attributes:{key:e,x:w(e),y:0,height:x,width:g(e),fill:(n=A(e))!=null?n:f[1],stroke:v,strokeWidth:`${k}px`,onClick:D(e),onMouseDown:F(e),onMouseUp:W(e),onMouseLeave:E(e)}}}),...Y.map(e=>{var n;return{name:"rect",type:"element",value:"",attributes:{key:e,x:$(e),y:0,width:t,height:j,fill:(n=A(e))!=null?n:f[0],stroke:"black",strokeWidth:`${k}px`,onClick:D(e),onMouseDown:F(e),onMouseUp:W(e),onMouseLeave:E(e)}}}),...Object.entries(R||{}).reduce((e,[n,r])=>{const h=b(n),p=I(h),N=C?t*.7:(p?j:x)-t*.7,z=p||C?$(h)+t/2:w(h)+g(h)/2;return e.concat([{name:"circle",value:r,attributes:{cx:z,cy:N,r:t/2,fill:f[1],stroke:f[0]}},{name:"text",value:r,attributes:{x:z,y:N+t*.2,textAnchor:"middle",fontFamily:"Verdana",fontSize:t*.7}}])},[])]}}function Q({options:u,onClick:o,onMouseDown:i,onMouseUp:a,onMouseLeave:s}){const l=P({options:u,onClick:o,onMouseDown:i,onMouseUp:a,onMouseLeave:s});return H.jsx("svg",{...l.attributes,children:l.children.map((c,m)=>{const f=c.name,{key:k,...v}=c.attributes;return H.jsx(f,{...v,children:c.value},`${c.name}-${m}`)})})}export{Q as C};
