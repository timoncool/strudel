import{I as M}from"./utils.TTqvgHvT.js";import{P as b,n as v,d as E}from"./index.CXEd7qFE.js";import"./prebake.Cdsm-3G8.js";import"./codemirror.CljggVKv.js";import"./index.Ds4Xb5JZ.js";import"./_commonjsHelpers.BosuxZz1.js";import"./spectrum.DtTj66Yt.js";import"./preload-helper.CLcXU_4U.js";import"./index.B9mnsnPE.js";/* empty css                      */const y=144,S=128,w=176;b.prototype.midi=function(a){return this.onTrigger((s,u,p,d)=>{let{note:o,nrpnn:x,nrpv:O,ccn:i,ccv:t,velocity:n=.9,gain:l=1}=s.value;const g=E(d,u)+34;n=Math.floor(l*n*100);const h=Math.floor(s.duration.valueOf()/p*1e3-10),c=Math.round(g),m=(s.value.midichan??1)-1,f=a??"IAC",e=[];if(o!=null){const r=typeof o=="number"?o:v(o);e.push({requestedport:f,message:[y+m,r,n],offset:c}),e.push({requestedport:f,message:[S+m,r,n],offset:c+h})}if(t&&i){if(typeof t!="number"||t<0||t>1)throw new Error("expected ccv to be a number between 0 and 1");if(!["string","number"].includes(typeof i))throw new Error("expected ccn to be a number or a string");const r=Math.round(t*127);e.push({requestedport:f,message:[w+m,i,r],offset:c})}e.length&&setTimeout(()=>{M("sendmidi",{messagesfromjs:e})})})};
