import{P as T}from"./index.CXEd7qFE.js";var a={},b=!1;async function P(n,s){if(!b){if(b=!0,n in a)return a[n];if("serial"in navigator){const e=await navigator.serial.requestPort();await e.open({baudRate:s});const r=new TextEncoder,o=e.writable.getWriter();a[n]=function(v,c){const t=r.encode(v);if(!c)o.write(t);else{const f=new Uint8Array(4);f[0]=124,f[1]=c>>8&255,f[2]=c&255,f[3]=59;const l=new Uint8Array(t.length+4);l.set(t),l.set(f,t.length),o.write(l)}}}else throw"Webserial is not available in this browser."}}const W=.1;function j(n){const s=n.length;if(s==0)return 0;for(var e=65535,r=0;r<s;++r){e^=n.charCodeAt(r)<<8;for(var o=0;o<8;++o)e=(e&32768)>0?e<<1^4129:e<<1}return e&65535}T.prototype.serial=function(n=115200,s=!1,e=!1,r="default"){return this.withHap(o=>{r in a||P(r,n);const v=(c,t,f,l,d)=>{var i="",g=0;if(typeof t.value=="object")if("action"in t.value){var w=t.value.action;e&&(w=w.charAt(0)),i+=w+"(";var x=!0;for(var[u,h]of Object.entries(t.value))u!=="action"&&(x?x=!1:i+=",",e&&(u=u.charAt(0)),i+=u+":"+h);i+=")",s&&(g=j(i))}else for(const[A,p]of Object.entries(t.value))i+=`${A}:${p}`;else i=t.value;const y=(d-f+W)*1e3;window.setTimeout(function(){a[r](i,g)},y)};return o.setContext({...o.context,onTrigger:v,dominantTrigger:!0})})};export{P as getWriter};
